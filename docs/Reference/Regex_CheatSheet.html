<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="generator" content="Madoko, version 1.1.6" />
  <meta name="viewport" content="initial-scale=1.0" />
  <meta name="description" content="Provides popup anchor links to headings in a web page.
     This makes it easier for others to link to specific sections
     in a large web manual or book." />
  <title>正则表达式</title>
  <style type="text/css"  class="link">
  /*# sourceURL=madoko.css */
  
  .madoko .toc>.tocblock .tocblock .tocblock {
    margin-left: 2.25em;
  }
  .madoko .toc>.tocblock .tocblock {
    margin-left: 1.5em;
  }
  .madoko .toc-contents>.tocblock>.tocitem {
    font-weight: bold;
  }
  .madoko .toc {
    margin-top: 1em;
  }
  .madoko p.para-continue {
    margin-bottom: 0pt;
  }
  .madoko .para-block+p {
    margin-top: 0pt;
  }
  .madoko ul.para-block, .madoko ol.para-block {
    margin-top: 0pt;
    margin-bottom: 0pt;
  }
  .madoko ul.para-end, .madoko ol.para-end {
    margin-bottom: 1em;
  }
  .madoko dl {
    margin-left: 0em;
  }
  .madoko blockquote {
    font-style: italic;
  }
  .madoko a.localref {
    text-decoration: none;
  }
  .madoko a.localref:hover {
    text-decoration: underline;
  }
  .madoko .footnotes {
    font-size: smaller;
    margin-top: 2em;
  }
  .madoko .footnotes hr {
    width: 50%;
    text-align: left;
  }
  .madoko .footnote { 
    margin-left: 1em;
  }
  .madoko .footnote-before {
    margin-left: -1em;
    width: 1em;
    display: inline-block;
  }
  .madoko .align-center, .madoko .align-center>p {
    text-align: center !important;
  }
  .madoko .align-center pre {
    text-align: left;
  }
  .madoko .align-center>* {
    margin-left: auto !important;
    margin-right: auto !important;
  }
  .madoko .align-left, .madoko .align-left>p {
    text-align: left !important;
  }
  .madoko .align-left>* {
    margin-left: 0pt !important;
    margin-right: auto !important;
  }
  .madoko .align-right, .madoko .align-right>p {
    text-align: right !important;
  }
  .madoko .align-right>* {
    margin-left: auto !important;
    margin-right: 0pt !important;
  }
  .madoko .align-center>table,
  .madoko .align-left>table,
  .madoko .align-right>table {
    text-align: left !important;
  }
  .madoko .equation-before {
    float: right;
  }
  .madoko .bibitem {
    font-size: smaller;
  }
  .madoko .bibsearch {
    font-size: x-small;
    text-decoration:none;
    color: black;
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  .madoko .block, .madoko .figure, .madoko .bibitem, .madoko .equation, .madoko div.math {
    margin-top: 1ex;
    margin-bottom: 1ex;
  }
  .madoko .figure {
    padding: 0.5em;
    margin-left: 0pt;
    margin-right: 0pt;
  }
  .madoko .hidden {
    display: none;
  }
  .madoko .invisible {
    visibility: hidden;
  }
  .madoko.preview .invisible {
    visibility: visible;
    opacity: 0.5;
  }
  .madoko code.code, .madoko span.code {
    white-space: pre-wrap;
  }
  .madoko hr, hr.madoko {
    border: none;
    border-bottom: black solid 1px;
    margin-bottom: 0.5ex;
  }
  .madoko .framed>*:first-child {
    margin-top: 0pt;
  }
  .madoko .framed>*:last-child {
    margin-bottom: 0pt;
  }
  .madoko ul.list-style-type-dash {
      list-style-type: none !important;
  }
  .madoko ul.list-style-type-dash > li:before {
      content: "\2013"; 
      position: absolute;
      margin-left: -1em; 
  }
  .madoko table.madoko {
    border-collapse: collapse;
  }
  .madoko td, .madoko th {
    padding: 0ex 0.5ex;
    margin: 0pt;
    vertical-align: top;
  }
  .madoko .cell-border-left {
    border-left: 1px solid black;
  }
  .madoko .cell-border-right {
    border-right: 1px solid black;
  }
  .madoko thead>tr:first-child>.cell-line,
  .madoko tbody:first-child>tr:first-child>.cell-line {
    border-top: 1px solid black;
    border-bottom: none;
  }
  .madoko .cell-line, .madoko .cell-double-line {
    border-bottom: 1px solid black;
    border-top: none;
  }
  .madoko .cell-double-line {
    border-top: 1px solid black;
    padding-top: 1.5px !important;
  }
  .madoko .input-mathpre .MathJax_Display {
    text-align: left !important;
  }
  .madoko div.input-mathpre {
    text-align: left;
    margin-top: 1.5ex;
    margin-bottom: 1ex;
  }
  .madoko .math-rendering {
    text-align: left;
    white-space: pre;
    color: gray;
  }
  .madoko .mathdisplay {
    text-align: center;
  }
  .madoko .pretty table {
    border-collapse: collapse;
  }
  .madoko .pretty td {
    padding: 0em;
  }
  .madoko .pretty td.empty {
    min-width: 1.5ex;
  }
  .madoko .pretty td.expander {
    width: 100em;
  }
  body.madoko, .madoko .serif {
    font-family: Cambria,"Times New Roman","Liberation Serif","Times",serif;
  }
  .madoko .sans-serif {
    font-family: "Calibri", "Optima", sans-serif;
  }
  .madoko .symbol {
    font-family: "Segoe UI Symbol", Symbola, serif;
  }
  body.madoko {  
    -webkit-text-size-adjust: 100%;       
    text-rendering: optimizeLegibility;
  }
  body.madoko {
    max-width: 88ex; 
    margin: 1em auto;
    padding: 0em 2em;  
  }
  body.preview.madoko {
    padding: 0em 1em;
  }
  .madoko p {
    text-align: justify;
  }
  .madoko h1, .madoko h2, .madoko h3, .madoko h4 { 
    margin-top: 1.22em; 
    margin-bottom: 1ex;
  }
  .madoko h1+p, .madoko h2+p, .madoko h3+p, .madoko h4+p, .madoko h5+p  { 
    margin-top: 1ex;    
  }
  .madoko h5, .madoko h6 { 
    margin-top: 1ex;
    font-size: 1em;
  }
  .madoko h5 { 
    margin-bottom: 0.5ex;
  }
  .madoko h5 + p {
    margin-top: 0.5ex;
  }
  .madoko h6 { 
    margin-bottom: 0pt;
  }
  .madoko h6 + p {
    margin-top: 0pt;
  }
  .madoko pre, .madoko code, .madoko kbd, .madoko samp, .madoko tt, 
  .madoko .monospace, .madoko .token-indent, .madoko .reveal pre, .madoko .reveal code, .madoko .email {
    font-family: Consolas,"Andale Mono WT","Andale Mono",Lucida Console,Monaco,monospace,monospace;
    font-size: 0.85em;
  }
  .madoko pre code, .madoko .token-indent {
    font-size: 0.95em;
  }
  .madoko pre code {
    font-family: inherit !important;
  }
  .madoko ol.linenums li {
    background-color: white;
    list-style-type: decimal;
  }
  .madoko .remote {
    background-color: #F0FFF0;
  }
  .madoko .remote + * {
    margin-top: 0pt;
  }
  @media print {
    body.madoko {
      font-size: 10pt;
    }
    @page {
      margin: 1in 1.5in;
    }
  }
  @media only screen and (max-device-width:1024px) {
    body.madoko {
      padding: 0em 0.5em;    
    }
    .madoko li {
      text-align: left;
    }
  }
  
    </style>
  
  <style>
    /* ---------------------------------------------
          Center document in the viewport
        ----------------------------------------------*/
        body.madoko {
          margin: 0pt;
          padding: 0pt;
          max-width: 100%;
        }
        .body {
          width: 70em;
          max-width: 90%;
          margin: 1em auto;
        }
        .preview .body {
          width: 98%;
          max-width: 100%;
          margin: 0.25em auto;
        }
        
        /* -----------------------------------------
           Settings for a wide viewport:
           The contents are shown in the side panel
           on the left side.
        -------------------------------------------- */
        @media (min-width: 1024px) {
          body.madoko {
            padding-right: 8%; /* looks more balanced with sidepanel */
          }       
          .sidepanel {
            width   : 14rem ; 
            position: fixed;
            top     : 3rem ;
            max-height: 90%;
            overflow-y: auto;
          }
          .mainpanel, .footnotes, .titleblock {
            margin-left: calc(14rem + 4rem + 2px + 1rem);
          }
          .tocblock2, .tocblock3 {
            display:none;
          }
          .tocblock.auto-expands, .tocblock.click-expands {
            display:block;
          }     
          /*
          .tocitem.current::after {
            content: "\00A0\25CF";
          }
          */
          .tocitem.current .heading-label {
            font-weight: bold;
          }      
          span.unexpanded, span.expanded {
            display: inline-block;
            width: 1.25em;
            margin-left: -1.25em;
            font-family: "Segoe UI Symbol", Symbola, serif;
            font-size: 70%;
            cursor: pointer;
            vertical-align: 0.1em;
          }
          span.unexpanded::before {
            content: "\25B6";
          }
          span.expanded::before {
            content: "\25BC";
          }
        }
        
        /* ---------------------------------------------------
           Set margins and padding for side panel and sections
        ------------------------------------------------------ */
        .sidepanel, .mainpanel section, .footnotes {
          padding: 0pt 1rem 0.25rem 1rem;
        }
        .sidepanel .tocblock {
          font-size  : small;
          white-space: nowrap;
        }
        .sidepanel .toc, .sidepanel h2, .sidepanel h1 {
          margin-top: 0pt;
        }
        .footnotes {
          padding-top: 0.5em; 
        }
        .footnotes>hr {
          display:none;
        }
        section,.sidepanel {
          margin-bottom: 1em;
        }
        
        /* -----------------------------------
           Nice scrollbar for toc
        ----------------------------------- */
        .sidepanel::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }     
        /* Track */
        .sidepanel::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,0.3); 
            -webkit-border-radius: 6px;
            border-radius: 6px;
        }    
        /* Handle */
        .sidepanel::-webkit-scrollbar-thumb {
            -webkit-border-radius: 6px;
            border-radius: 6px;
            background: lightgray; 
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,0.5); 
        }
        .sidepanel::-webkit-scrollbar-thumb:window-inactive {
          background: gainsboro; 
        }
        .madoko .toc > .tocblock .tocblock .tocblock {
          margin-left: 1.5em;
        }
        .madoko .toc a {
          color: #444; 
        }
    h0:hover .entity-anchor,
        h1:hover .entity-anchor,
        h2:hover .entity-anchor,
        h3:hover .entity-anchor {
          display: inline-block;
        }
        
        a.entity-anchor {
          color: black;
        }
        
        a.localref.entity-anchor:hover {
          text-decoration: none;
        }
        
        .entity-anchor {
          display: none;
          width: 0.8em;
          margin-left: -0.8em;
          font-family: "Segoe UI Symbol", Symbola, serif;
          font-size: 80%;
        }
  </style>
  </head>
<body class="madoko">

<div class="body madoko" style="line-adjust:0">

<div class="titleblock align-center para-block" style="text-align:center;line-adjust:0">
<div class="titleheader align-center" style="text-align:center;line-adjust:0">
<div class="title para-block" style="font-size:xx-large;font-weight:bold;margin-bottom:0.5ex;line-adjust:0">正则表达式</div></div></div>
<div class="sidepanel">
<span data-line=""></span>
<nav class="toc toc-contents">
<div class="tocblock tocblock1">
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-1-" data-toc-depth="1" data-toc-line="1. \u6B63\u5219\u8868\u8FBE\u5F0F\u7B80\u4ECB" style="toctarget:sec-1-"><a href="#sec-1-" class="localref">1. 正则表达式简介</a></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-2-" data-toc-depth="1" data-toc-line="2. \u6B63\u5219\u8868\u8FBE\u5F0F\u8BED\u6CD5" style="toctarget:sec-2-"><a href="#sec-2-" class="localref">2. 正则表达式语法</a></div>
<div class="tocblock tocblock2">
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-21-" data-toc-depth="2" data-toc-line="2.1. \u8F6C\u4E49\u5B57\u7B26" style="toctarget:sec-21-"><a href="#sec-21-" class="localref">2.1. 转义字符</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-22-" data-toc-depth="2" data-toc-line="2.2. \u63A7\u5236\u8F6C\u4E49\u5B57\u7B26" style="toctarget:sec-22-"><a href="#sec-22-" class="localref">2.2. 控制转义字符</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-23-" data-toc-depth="2" data-toc-line="2.3. \u5B57\u7B26\u96C6\u5408" style="toctarget:sec-23-"><a href="#sec-23-" class="localref">2.3. 字符集合</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-24-" data-toc-depth="2" data-toc-line="2.4. \u81EA\u5B9A\u4E49\u5B57\u7B26\u96C6\u5408" style="toctarget:sec-24-"><a href="#sec-24-" class="localref">2.4. 自定义字符集合</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-25-" data-toc-depth="2" data-toc-line="2.5. \u5339\u914D\u6B21\u6570\u9650\u5B9A\u7B26" style="toctarget:sec-25-"><a href="#sec-25-" class="localref">2.5. 匹配次数限定符</a></div>
<div class="tocblock tocblock3">
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-251-" data-toc-depth="3" data-toc-line="2.5.1. \u201C\u52C9\u5F3A\u6A21\u5F0F\u201D\u9650\u5B9A\u7B26" style="toctarget:sec-251-"><a href="#sec-251-" class="localref">2.5.1. “勉强模式”限定符</a></div>
<div class="tocitem tocitem3" data-toc-target-elem="h3" data-toc-target="sec-252-" data-toc-depth="3" data-toc-line="2.5.2. \u201C\u5360\u6709\u6A21\u5F0F\u201D\u9650\u5B9A\u7B26" style="toctarget:sec-252-"><a href="#sec-252-" class="localref">2.5.2. “占有模式”限定符</a></div></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-26-" data-toc-depth="2" data-toc-line="2.6. \u5B57\u7B26\u8FB9\u754C" style="toctarget:sec-26-"><a href="#sec-26-" class="localref">2.6. 字符边界</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-27-" data-toc-depth="2" data-toc-line="2.7. \u9009\u62E9\u8868\u8FBE\u5F0F" style="toctarget:sec-27-"><a href="#sec-27-" class="localref">2.7. 选择表达式</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-28-" data-toc-depth="2" data-toc-line="2.8. \u6355\u83B7\u7EC4" style="toctarget:sec-28-"><a href="#sec-28-" class="localref">2.8. 捕获组</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-29-" data-toc-depth="2" data-toc-line="2.9. \u975E\u6355\u83B7\u7EC4" style="toctarget:sec-29-"><a href="#sec-29-" class="localref">2.9. 非捕获组</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-210-" data-toc-depth="2" data-toc-line="2.10. \u53CD\u5411\u5F15\u7528" style="toctarget:sec-210-"><a href="#sec-210-" class="localref">2.10. 反向引用</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-211-" data-toc-depth="2" data-toc-line="2.11. \u6CE8\u91CA" style="toctarget:sec-211-"><a href="#sec-211-" class="localref">2.11. 注释</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-212-" data-toc-depth="2" data-toc-line="2.12. \u9884\u641C\u7D22" style="toctarget:sec-212-"><a href="#sec-212-" class="localref">2.12. 预搜索</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-213-" data-toc-depth="2" data-toc-line="2.13. \u6761\u4EF6\u8868\u8FBE\u5F0F" style="toctarget:sec-213-"><a href="#sec-213-" class="localref">2.13. 条件表达式</a></div>
<div class="tocitem tocitem2" data-toc-target-elem="h2" data-toc-target="sec-214-" data-toc-depth="2" data-toc-line="2.14. \u9012\u5F52\u8868\u8FBE\u5F0F" style="toctarget:sec-214-"><a href="#sec-214-" class="localref">2.14. 递归表达式</a></div></div>
<div class="tocitem tocitem1" data-toc-target-elem="h1" data-toc-target="sec-3-" data-toc-depth="1" data-toc-line="3. \u6B63\u5219\u8868\u8FBE\u5F0F\u7684\u5EFA\u8BAE" style="toctarget:sec-3-"><a href="#sec-3-" class="localref">3. 正则表达式的建议</a></div></div></nav></div>
<div class="mainpanel">
<h2 id="sec-1-" class="clearnum h1" data-heading-depth="1" style="display:block">1. 正则表达式简介</h2>
<p class="p noindent">正则表达式，又称正规表示式、正规表示法、正规表达式、规则表达式、常规表示法（英语：Regular Expression，在代码中常简写为regex、regexp或RE），计算机科学的一个概念。正则表达式使用单个字符串来描述、匹配一系列符合某个句法规则的字符串。在很多文本编辑器里，正则表达式通常被用来检索、替换那些符合某个模式的文本。
</p>
<p class="p indent">许多程序设计语言都支持利用正则表达式进行字符串操作。例如，在Perl中就内建了一个功能强大的正则表达式引擎。正则表达式这个概念最初是由Unix中的工具软件（例如sed和grep）普及开的。正则表达式通常缩写成“regex”，单数有regexp、regex，复数有regexps、regexes、regexen。
</p>
<p class="p indent">正则表达式引擎是一种可以处理正则表达式的软件。通常，引擎是更大的应用程序的一部分。在软件世界，不同的正则表达式并不互相兼容。知道正则表达式引擎是如何工作的有助于你很快理解为何某个正则表达式不像你期望的那样工作。
</p>
<p class="p indent">正则表达式引擎有两种类型的引擎：文本导向(text-directed)的引擎和正则导向(regex-directed)的引擎，分别被称作DFA(确定性有限状态自动机) 引擎和NFA(非确定有限状态自动机)引擎。这两种引擎都有了很久的历史(至今二十多年)，当中也由这两种引擎产生了很多变体。POSIX的出台规避了不必要变体的继续产生。这样一来，主流的正则引擎又分为3类： DFA、传统型NFA、POSIX NFA。
</p>
<ul class="ul list-dash compact">
<li class="li ul-li list-dash-li compact-li">DFA引擎在线性时状态下执行，因为它们不要求回溯（并因此它们永远不测试相同的字符两次）。DFA引擎还可以确保匹配最长的可能的字符串。但是，因为 DFA 引擎只包含有限的状态，所以它不能匹配具有反向引用的模式；并且因为它不构造显示扩展，所以它不可以捕获子表达式。
</li>
<li class="li ul-li list-dash-li compact-li">传统的NFA引擎运行所谓的“贪婪的”匹配回溯算法，以指定顺序测试正则表达式的所有可能的扩展并接受第一个匹配项。因为传统的NFA构造正则表达式的特定扩展以获得成功的匹配，所以它可以捕获子表达式匹配和匹配的反向引用。但是，因为传统的 NFA 回溯，所以它可以访问完全相同的状态多次（如果通过不同的路径到达该状态）。因此，在最坏情况下，它的执行速度可能非常慢。因为传统的 NFA接受它找到的第一个匹配，所以它还可能会导致其他（可能更长）匹配未被发现。一些非常有用的特性，如“惰性”量词(lazy quantifiers)和反向引用(back references)，只能在NFA引擎中实现。
</li>
<li class="li ul-li list-dash-li compact-li">POSIX NFA 引擎与传统的NFA引擎类似，不同的一点在于：在它们可以确保已找到了可能的最长的匹配之前，它们将继续回溯。因此，POSIX NFA引擎的速度慢于传统的NFA引擎；并且在使用POSIX NFA时，您恐怕不会愿意在更改回溯搜索的顺序的情况下来支持较短的匹配搜索，而非较长的匹配搜索。
</li></ul>

<p class="p noindent">使用DFA引擎的程序主要有：awk，egrep，flex，lex，MySQL，Procmail等；
使用传统型NFA引擎的程序主要有：GNU Emacs，Java，ergp，less，more，.NET，PCRE library，Perl，PHP，Python，Ruby，sed，vi；
使用POSIX NFA引擎的程序主要有：mawk，Mortice Kern Systems’ utilities，GNU Emacs(使用时可以明确指定)；
使用DFA/NFA混合的引擎：GNU awk，GNU grep/egrep，Tcl。
</p>
<p class="p indent">举例简单说明NFA与DFA工作的区别。比如有字符串 <code class="code code1" style="color:red">this is yaabc’s blog</code>，正则表达式为 <code class="code code1" style="color:red">ya(msen|nsen|nsem)</code>。 
</p>
<p class="p indent">NFA工作方式如下，先在字符串中查找 <code class="code code1" style="color:red">y</code> 然后匹配其后是否为 <code class="code code1" style="color:red">a</code>，如果是 <code class="code code1" style="color:red">a</code> 则继续，查找其后是否为 <code class="code code1" style="color:red">m</code> 如果不是则匹配其后是否为 <code class="code code1" style="color:red">n</code> (此时淘汰 <code class="code code1" style="color:red">msen</code> 选择支)。然后继续看其后是否依次为 <code class="code code1" style="color:red">s</code>， <code class="code code1" style="color:red">e</code>，接着测试是否为 <code class="code code1" style="color:red">n</code>，是 <code class="code code1" style="color:red">n</code>则匹配成功，不是则测试是否为 <code class="code code1" style="color:red">m</code>。因为NFA工作方式是以正则表达式为标准，反复测试字符串，这样同样一个字符串有可能被反复测试了很多次。而DFA则不是如此，DFA会从 <code class="code code1" style="color:red">this</code> 中 <code class="code code1" style="color:red">t</code> 开始依次查找 <code class="code code1" style="color:red">y</code>，定位到 <code class="code code1" style="color:red">y</code>，已知其后为 <code class="code code1" style="color:red">a</code>，则查看表达式是否有 <code class="code code1" style="color:red">a</code>，此处正好有 <code class="code code1" style="color:red">a</code>。然后字符串 <code class="code code1" style="color:red">a</code> 后为 <code class="code code1" style="color:red">n</code>，DFA依次测试表达式，此时 <code class="code code1" style="color:red">msen</code> 不符合要求淘汰。<code class="code code1" style="color:red">nsen</code> 和 <code class="code code1" style="color:red">nsem</code> 符合要求，然后DFA依次检查字符串，检测到 <code class="code code1" style="color:red">sen</code> 中的 <code class="code code1" style="color:red">n</code> 时只有 <code class="code code1" style="color:red">nsen</code> 分支符合，则匹配成功。
</p>
<p class="p indent">你可以轻易分辨出所使用的引擎是文本导向还是正则导向。如果反向引用或“惰性”量词被实现，则可以肯定你使用的引擎是正则导向的。你可以作如下测试：将正则表达式 <code class="code code1" style="color:red">&lt;&lt;regex|regex not&gt;&gt;</code> 应用到字符串 <code class="code code1" style="color:red">regex not</code>。如果匹配的结果是 <code class="code code1" style="color:red">regex</code>，则引擎是正则导向的。如果结果是 <code class="code code1" style="color:red">regex not</code>，则是文本导向的。这是因为正则导向的引擎总是返回最左边的匹配。这是需要理解的很重要的一点：即使以后有可能发现一个“更好”的匹配，正则导向的引擎也总是返回最左边的匹配。
</p>
<p class="p indent">NFA以表达式为主导，DFA以文本为主导。一般而论，DFA引擎则搜索更快一些；但是NFA以表达式为主导，反而更容易操纵，因此一般程序员更偏爱NFA引擎。两种引擎各有所长，而真正的引用则取决与你的需要以及所使用的语言。
</p><h2 id="sec-2-" class="clearnum h1" data-heading-depth="1" style="display:block">2. 正则表达式语法</h2><h3 id="sec-21-" class="clearnum h2" data-heading-depth="2" style="display:block">2.1. 转义字符</h3>
<p class="p noindent">一些不便书写的字符，比如换行符，制表符等，使用 <code class="code code1" style="color:red">\n</code>，<code class="code code1" style="color:red">\t</code> 来表示。另外有一些标点符号在正则表达式中，被定义了特殊的意义，因此需要在前面加 <code class="code code1" style="color:red">\</code> 进行转义后，匹配该字符本身。
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">转义符           </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">说明                                                                     </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\a</code>             </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">响铃符 = <code class="code code1" style="color:red">\x07</code>                                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\f</code>             </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">换页符 = <code class="code code1" style="color:red">\x0C</code>                                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\n</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">换行符 = <code class="code code1" style="color:red">\x0A</code>                                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\r</code>             </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="2" style="width:20cm;background-color:White">回车符 = <code class="code code1" style="color:red">\x0D</code>                                                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\t</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro">制表符 = <code class="code code1" style="color:red">\x09</code>                                                          </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\v</code>             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="2" style="width:20cm;background-color:White">垂直制表符 = <code class="code code1" style="color:red">\x0B</code>                                                      </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\e</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="2" style="width:20cm;background-color:Gainsboro">ESC符 = <code class="code code1" style="color:red">\x1B</code>                                                           </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\x20</code>           </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="2" style="width:20cm;background-color:White">使用两位十六进制表示形式，可与该编号的字符匹配                           </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\u002B</code>         </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="2" style="width:20cm;background-color:Gainsboro">使用四位十六进制表示形式，可与该编号的字符匹配                           </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\x{20A060}</code>     </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="2" style="width:20cm;background-color:White">使用任意位十六进制表示形式，可与该编号的字符匹配                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">^</code>              </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="2" style="width:20cm;background-color:Gainsboro">匹配输入字符串的开始位置。要匹配 <code class="code code1" style="color:red">^</code> 字符本身，请使用 <code class="code code1" style="color:red">\^</code>               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">$</code>             </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="2" style="width:20cm;background-color:White">匹配输入字符串的结尾位置。要匹配 <code class="code code1" style="color:red">$</code> 字符本身，请使用 <code class="code code1" style="color:red">\$</code>               </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="13" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">( )</code>            </td><td class="tbody tr-odd col col-even col-last" data-row="13" data-col="2" style="width:20cm;background-color:Gainsboro">标记一个子表达式的开始和结束位置。要匹配小括号，请使用 <code class="code code1" style="color:red">\(</code> 和 <code class="code code1" style="color:red">\)</code>      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="14" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[ ]</code>            </td><td class="tbody tr-even col col-even col-last" data-row="14" data-col="2" style="width:20cm;background-color:White">用来自定义能够匹配 &#8216;多种字符&#8217; 的表达式。要匹配中括号，请使用 <code class="code code1" style="color:red">\[</code> 和 <code class="code code1" style="color:red">\]</code></td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="15" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">{ }</code>            </td><td class="tbody tr-odd col col-even col-last" data-row="15" data-col="2" style="width:20cm;background-color:Gainsboro">修饰匹配次数的符号。要匹配大括号，请使用 <code class="code code1" style="color:red">\{</code> 和 <code class="code code1" style="color:red">\}</code>                    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="16" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">.</code>              </td><td class="tbody tr-even col col-even col-last" data-row="16" data-col="2" style="width:20cm;background-color:White">匹配除了换行符（<code class="code code1" style="color:red">\n</code>）以外的任意一个字符。要匹配小数点本身，请使用 <code class="code code1" style="color:red">\.</code>  </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="17" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">?</code>              </td><td class="tbody tr-odd col col-even col-last" data-row="17" data-col="2" style="width:20cm;background-color:Gainsboro">修饰匹配次数为 0 次或 1 次。要匹配 <code class="code code1" style="color:red">?</code> 字符本身，请使用 <code class="code code1" style="color:red">\?</code>             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="18" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">+</code>              </td><td class="tbody tr-even col col-even col-last" data-row="18" data-col="2" style="width:20cm;background-color:White">修饰匹配次数为至少 1 次。要匹配 <code class="code code1" style="color:red">+</code> 字符本身，请使用 <code class="code code1" style="color:red">\+</code>                </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="19" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">*</code>              </td><td class="tbody tr-odd col col-even col-last" data-row="19" data-col="2" style="width:20cm;background-color:Gainsboro">修饰匹配次数为 0 次或任意次。要匹配 <code class="code code1" style="color:red">*</code> 字符本身，请使用 <code class="code code1" style="color:red">\*</code>            </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="20" data-col="1" style="width:20%;background-color:White"><span style="color:red">|</span>  </td><td class="tbody tr-even col col-even col-last" data-row="20" data-col="2" style="width:20cm;background-color:White">左右两边表达式之间 &#8220;或&#8221; 关系。匹配 <span style="color:red">|</span> 本身，请使用 <code class="code code1" style="color:red">\|</code>     </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="21" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\</code>              </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="21" data-col="2" style="width:20cm;background-color:Gainsboro">用来进行转义的转义字符。匹配 <code class="code code1" style="color:red">\</code> 本身，请使用 <code class="code code1" style="color:red">\\</code>                      </td></tr>
<tr><td class="tbody tr-odd col cell-line col-odd col-first" data-row="21" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-odd col cell-line col-even col-last" data-row="21" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr></tbody></table><h3 id="sec-22-" class="clearnum h2" data-heading-depth="2" style="display:block">2.2. 控制转义字符</h3>
<p class="p noindent">使用 <code class="code code1" style="color:red">\Q</code> 开始，<code class="code code1" style="color:red">\E</code> 结束，可使中间的标点符号失去特殊意义，将中间的字符作为普通字符。
</p>
<p class="p indent">使用 <code class="code code1" style="color:red">\U</code> 开始，<code class="code code1" style="color:red">\E</code> 结束，除了具有 <code class="code code1" style="color:red">\Q...\E</code> 相同的功能外，还将中间的小写字母转换成大写。在大小写敏感模式下，只能与大写文本匹配。
</p>
<p class="p indent">使用 <code class="code code1" style="color:red">\L</code> 开始，<code class="code code1" style="color:red">\E</code> 结束，除了具有 <code class="code code1" style="color:red">\Q...\E</code> 相同的功能外，还将中间的大写字母转换成小写。在大小写敏感模式下，只能与小写文本匹配。
</p><h3 id="sec-23-" class="clearnum h2" data-heading-depth="2" style="display:block">2.3. 字符集合</h3>
<p class="p noindent">可以匹配 &#8220;多个字符&#8221; 其中任意一个字符的正则表达式。虽然是 &#8220;多个字符&#8221;，但每次只能匹配其中一个。
</p>
<p class="p indent">正则表达式中标准的字符集合有：
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">字符             </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">集合说明                                               </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">.</code>              </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">小数点可以匹配除了换行符（<code class="code code1" style="color:red">\n</code>）以外的任意一个字符     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\w</code>             </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">可以匹配任何一个字母或者数字或者下划线                 </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\W</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">W大写，可以匹配任何一个字母或者数字或者下划线以外的字符</td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\s</code>             </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="2" style="width:20cm;background-color:White">可以匹配空格、制表符、换页符等空白字符的其中任意一个   </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\S</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro">S大写，可以匹配任何一个空白字符以外的字符              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">\d</code>             </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="2" style="width:20cm;background-color:White">可以匹配任何一个 <code class="code code1" style="color:red">0~9</code> 数字字符                        </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\D</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="2" style="width:20cm;background-color:Gainsboro">D大写，可以匹配任何一个非数字字符                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[:alpha:]</code>      </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="2" style="width:20cm;background-color:White">POSIX 格式，可以匹配任何一个字母                       </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="9" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:^alpha:]</code>     </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="9" data-col="2" style="width:20cm;background-color:Gainsboro">POSIX 否定格式，可以匹配任何一个字母以外的字符         </td></tr>
<tr><td class="tbody tr-odd col cell-line col-odd col-first" data-row="9" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-odd col cell-line col-even col-last" data-row="9" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr></tbody></table>
<p class="p noindent">POSIX 字符集合定义有：
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">POSIX 字符集合   </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">说明                                                  </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:alnum:]</code>      </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">任何一个字母或数字（<code class="code code1" style="color:red">A-Z</code>, <code class="code code1" style="color:red">a-z</code>, <code class="code code1" style="color:red">0-9</code>）             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[:alpha:]</code>      </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">任何一个字母（<code class="code code1" style="color:red">A-Z</code>, <code class="code code1" style="color:red">a-z</code>）                          </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:ascii:]</code>      </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">任何一个 ASCII 范围内字符（<code class="code code1" style="color:red">\x00–\x7F</code>）              </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[:cntrl:]</code>      </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="2" style="width:20cm;background-color:White">任何一个控制字符（<code class="code code1" style="color:red">\x00–\x1F</code>, <code class="code code1" style="color:red">\x7F</code>）               </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:digit:]</code>      </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro">任何一个数字（<code class="code code1" style="color:red">0–9</code>）                                 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="6" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[:print:]</code>      </td><td class="tbody tr-even col col-even col-last" data-row="6" data-col="2" style="width:20cm;background-color:White">任何一个可显示的 ASCII 字符（<code class="code code1" style="color:red">\x20–\x7E</code>）            </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="7" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:space:]</code>      </td><td class="tbody tr-odd col col-even col-last" data-row="7" data-col="2" style="width:20cm;background-color:Gainsboro">任何一个空白字符（<code class="code code1" style="color:red">\x09–\x0D</code>, <code class="code code1" style="color:red">\x20</code>）               </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="8" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[:graph:]</code>      </td><td class="tbody tr-even col col-even col-last" data-row="8" data-col="2" style="width:20cm;background-color:White">任何一个可显示的 ASCII 字符，不包含空格（<code class="code code1" style="color:red">\x21–\x7E</code>）</td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="9" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:lower:]</code>      </td><td class="tbody tr-odd col col-even col-last" data-row="9" data-col="2" style="width:20cm;background-color:Gainsboro">任何一个小写字母（<code class="code code1" style="color:red">a–z</code>）                             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="10" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[:punct:]</code>      </td><td class="tbody tr-even col col-even col-last" data-row="10" data-col="2" style="width:20cm;background-color:White">可显示字符 <code class="code code1" style="color:red">[:print:]</code> 中除去字母数字 <code class="code code1" style="color:red">[:alnum:]</code>     </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="11" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:upper:]</code>      </td><td class="tbody tr-odd col col-even col-last" data-row="11" data-col="2" style="width:20cm;background-color:Gainsboro">任何一个大写字母（<code class="code code1" style="color:red">A–Z</code>）                             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="12" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">[:xdigit:]</code>     </td><td class="tbody tr-even col col-even col-last" data-row="12" data-col="2" style="width:20cm;background-color:White">任何一个十六进制数字（<code class="code code1" style="color:red">0-9</code>, <code class="code code1" style="color:red">A-F</code>, <code class="code code1" style="color:red">a-f</code>）           </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="13" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">[:blank:]</code>      </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="13" data-col="2" style="width:20cm;background-color:Gainsboro">空格或者制表符（<code class="code code1" style="color:red">\x20</code>, <code class="code code1" style="color:red">\x09</code>）                      </td></tr>
<tr><td class="tbody tr-odd col cell-line col-odd col-first" data-row="13" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-odd col cell-line col-even col-last" data-row="13" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr></tbody></table><h3 id="sec-24-" class="clearnum h2" data-heading-depth="2" style="display:block">2.4. 自定义字符集合</h3>
<p class="p noindent">用中括号 <code class="code code1" style="color:red">[ ]</code> 包含多个字符，可以匹配所包含的字符中的任意一个。同样，每次只能匹配其中一个。比如 <code class="code code1" style="color:red">[abc]</code> 会匹配 <code class="code code1" style="color:red">a</code>， <code class="code code1" style="color:red">b</code>， <code class="code code1" style="color:red">c</code> 中的任意一个字符。
</p>
<p class="p indent">用中括号 <code class="code code1" style="color:red">[^ ]</code> 包含多个字符，构成否定格式，可以匹配所包含的字符之外的任意一个字符。比如 <code class="code code1" style="color:red">[^abc]</code> 会匹配除 <code class="code code1" style="color:red">a</code>， <code class="code code1" style="color:red">b</code>， <code class="code code1" style="color:red">c</code> 外的任意一个字符。
</p>
<ul class="ul list-dash compact">
<li class="li ul-li list-dash-li compact-li">正则表达式中的特殊符号，如果被包含于中括号中，则失去特殊意义，但 <code class="code code1" style="color:red">\ [ ] : ^ -</code> 除外。
</li>
<li class="li ul-li list-dash-li compact-li">标准字符集合，除小数点(<code class="code code1" style="color:red">.</code>)外，如果被包含于中括号中，自定义字符集合将包含该集合。比如：<code class="code code1" style="color:red">[\d.-+]</code>，将可以匹配数字，小数点和 <code class="code code1" style="color:red">+ -</code> 符号。（小数点和 <code class="code code1" style="color:red">+</code> 号失去特殊意义）
</li>
<li class="li ul-li list-dash-li compact-li">用减号相连的 2 个普通字符，自定义字符集合将包含该范围。比如：<code class="code code1" style="color:red">[\dA-Fa-f]</code>，将可以匹配 <code class="code code1" style="color:red">0 - 9</code>，<code class="code code1" style="color:red">A - F</code>，<code class="code code1" style="color:red">a - f</code>。
</li>
<li class="li ul-li list-dash-li compact-li">自定义字符集合可以包含 POSIX 字符集合。
</li></ul>
<h3 id="sec-25-" class="clearnum h2" data-heading-depth="2" style="display:block">2.5. 匹配次数限定符</h3>
<p class="p noindent">使被修饰的表达式可多次重复匹配的修饰符。可使被修饰的表达式重复固定次数，也可以限定一定的重复匹配的次数范围。
</p>
<p class="p indent">在限定符之后的表达式能够匹配成功的情况下，不定次数的限定符总是尽可能的多匹配。如果之后的表达式匹配失败，限定符可适当“让出”能够匹配的字符，以使整个表达式匹配成功。这种模式就叫“贪婪模式”。
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">限定符           </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">说明                                                                       </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">{n}</code>            </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">表达式固定重复n次，比如：<code class="code code1" style="color:red">\w{2}</code> 相当于 <code class="code code1" style="color:red">\w\w</code>                             </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">{m, n}</code>         </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">表达式尽可能重复n次，至少重复m次：<code class="code code1" style="color:red">ba{1,3}</code>可以匹配 <code class="code code1" style="color:red">ba</code> 或 <code class="code code1" style="color:red">baa</code> 或 <code class="code code1" style="color:red">baaa</code></td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">{m, }</code>          </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽可能的多匹配，至少重复m次：<code class="code code1" style="color:red">\w\d{2,}</code>可以匹配 <code class="code code1" style="color:red">a12</code>, <code class="code code1" style="color:red">x456</code>&#8230;     </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">?</code>              </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="2" style="width:20cm;background-color:White">表达式尽可能匹配1次，也可以不匹配，相当于 <code class="code code1" style="color:red">{0, 1}</code>                         </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">+</code>              </td><td class="tbody tr-odd col col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽可能的多匹配，至少匹配1次，相当于 <code class="code code1" style="color:red">{1, }</code>                          </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="6" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">*</code>              </td><td class="tbody tr-even tr-last col col-even col-last" data-row="6" data-col="2" style="width:20cm;background-color:White">表达式尽可能的多匹配，最少可以不匹配，相当于 <code class="code code1" style="color:red">{0, }</code>                       </td></tr>
<tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="6" data-col="1" style="width:20%;background-color:White"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="6" data-col="2" style="width:20cm;background-color:White"></td></tr></tbody></table><h4 id="sec-251-" class="clearnum h3" data-heading-depth="3" style="display:block">2.5.1. “勉强模式”限定符</h4>
<p class="p noindent">在限定符之后添加问号(<code class="code code1" style="color:red">?</code>)，则使限定符成为“勉强模式”。勉强模式的限定符，总是尽可能少的匹配。如果之后的表达式匹配失败，勉强模式也可以尽可能少的再匹配一些，以使整个表达式匹配成功。
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">限定符           </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">说明                                                  </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">{m, n}?</code>        </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽量只匹配m次，最多重复n次。                    </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">{m, }?</code>         </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">表达式尽量只匹配m次，最多可以匹配任意次。             </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">??</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽量不匹配，最多匹配1次，相当于 <code class="code code1" style="color:red">{0, 1}?</code>       </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">+?</code>             </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="2" style="width:20cm;background-color:White">表达式尽量只匹配1次，最多可匹配任意次，相当于 <code class="code code1" style="color:red">{1, }?</code></td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">*?</code>             </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽量不匹配，最多可匹配任意次，相当于 <code class="code code1" style="color:red">{0, }?</code>   </td></tr>
<tr><td class="tbody tr-odd col cell-line col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-odd col cell-line col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr></tbody></table><h4 id="sec-252-" class="clearnum h3" data-heading-depth="3" style="display:block">2.5.2. “占有模式”限定符</h4>
<p class="p noindent">在限定符之后添加加号(<code class="code code1" style="color:red">+</code>)，则使限定符成为“占有模式”。占有模式的限定符，总是尽可能多的匹配。与“贪婪模式”不同的是，即使之后的表达式匹配失败，“占有模式”也不会“让出”自己能够匹配的字符。
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">限定符           </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">说明                                                 </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">{m, n}+</code>        </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽可能重复n次，至少重复m次。                   </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">{m, }+</code>         </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">表达式尽可能的多匹配，至少重复m次。                  </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">?+</code>             </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽可能匹配1次，也可以不匹配，相当于 <code class="code code1" style="color:red">{0, 1}+</code>  </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">++</code>             </td><td class="tbody tr-even col col-even col-last" data-row="4" data-col="2" style="width:20cm;background-color:White">表达式尽可能的多匹配，至少匹配1次，相当于 <code class="code code1" style="color:red">{1, }+</code>   </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">*+</code>             </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro">表达式尽可能的多匹配，最少可以不匹配，相当于 <code class="code code1" style="color:red">{0, }+</code></td></tr>
<tr><td class="tbody tr-odd col cell-line col-odd col-first" data-row="5" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-odd col cell-line col-even col-last" data-row="5" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr></tbody></table><h3 id="sec-26-" class="clearnum h2" data-heading-depth="2" style="display:block">2.6. 字符边界</h3>
<p class="p noindent">本身不匹配任何字符，只对字符边界和字符间缝隙附加条件的表达式。
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">边界条件         </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">说明                                              </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">^</code>              </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">当前位置必须是文本开始位置。                      </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White"><code class="code code1" style="color:red">$</code>              </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">当前位置必须是文本结束位置。                      </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"><code class="code code1" style="color:red">\b</code>             </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">当前位置的左右两侧，只能有一侧是字母数字或下划线。</td></tr>
<tr><td class="tbody tr-odd col cell-line col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-odd col cell-line col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr></tbody></table>
<ul class="ul list-dash compact">
<li class="li ul-li list-dash-li compact-li">当 <code class="code code1" style="color:red">\b</code> 被包含于字符集合中时，<code class="code code1" style="color:red">\b</code> 代表退格符（ASCII码 = 8）。这个边界符常常用来匹配单词边界，比如，<code class="code code1" style="color:red">\bend\b</code> 匹配单词 <code class="code code1" style="color:red">end</code>，但不会匹配到 <code class="code code1" style="color:red">weekend</code>。
</li></ul>
<h3 id="sec-27-" class="clearnum h2" data-heading-depth="2" style="display:block">2.7. 选择表达式</h3>
<p class="p noindent">使用竖线 <code class="code code1" style="color:red">|</code> 分隔多段表达式，整个表达式可匹配其中任意一段。
</p><h3 id="sec-28-" class="clearnum h2" data-heading-depth="2" style="display:block">2.8. 捕获组</h3>
<p class="p noindent">捕获组，就是把正则表达式中子表达式匹配的内容，保存到内存中以数字编号或显式命名的组里，方便后面引用。
捕获组有两种形式，一种是普通捕获组 <code class="code code1" style="color:red">( )</code>，另一种是命名捕获组 <code class="code code1" style="color:red">(?&lt;name&gt;xxx)</code>。
</p>
<p class="p indent">举例来说，使用普通捕获组匹配一个时间数字串，这种方式只能通过编号来访问捕获组。捕获组的编号是按照 <code class="code code1" style="color:red">(</code> 出现的顺序，从左到右，从1开始进行编号的，注意，编号0代表整个匹配的字符串 。
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%"></th><th class="thead tr-even col cell-line col-even" data-row="0" data-col="2" style="width:40%"></th><th class="thead tr-even col cell-line col-odd col-last" data-row="0" data-col="3" style="width:10cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:20%">编号             </th><th class="col thead tr-odd tr-last tr-first col-even" data-row="1" data-col="2" style="font-weight:bold;width:40%">捕获组                  </th><th class="col thead tr-odd tr-last tr-first col-odd col-last" data-row="1" data-col="3" style="font-weight:bold;width:10cm">匹配内容          </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2" style="width:40%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="0" data-col="3" style="width:10cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:20%;background-color:Gainsboro">0                </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2" style="width:40%;background-color:Gainsboro"><code class="code code1" style="color:red">(\d{4})-(\d{2}-(\d\d))</code></td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="3" style="width:10cm;background-color:Gainsboro">2008-12-31        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:20%;background-color:White">1                </td><td class="tbody tr-even col col-even" data-row="2" data-col="2" style="width:40%;background-color:White"><code class="code code1" style="color:red">(\d{4})</code>               </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="3" style="width:10cm;background-color:White">2008              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:20%;background-color:Gainsboro">2                </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2" style="width:40%;background-color:Gainsboro"><code class="code code1" style="color:red">(\d{2}-(\d\d))</code>        </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="3" style="width:10cm;background-color:Gainsboro">12-31             </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White">3                </td><td class="tbody tr-even tr-last col col-even" data-row="4" data-col="2" style="width:40%;background-color:White"><code class="code code1" style="color:red">(\d\d)</code>                </td><td class="tbody tr-even tr-last col col-odd col-last" data-row="4" data-col="3" style="width:10cm;background-color:White">31                </td></tr>
<tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="4" data-col="1" style="width:20%;background-color:White"></td><td class="tbody tr-even col cell-line col-even" data-row="4" data-col="2" style="width:40%;background-color:White"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="4" data-col="3" style="width:10cm;background-color:White"></td></tr></tbody></table>
<p class="p noindent">接着，使用命名捕获组匹配一个时间数字串，这种方式既可通过编号来访问各组，也可以直接通过命名来访问各组。
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:10%"></th><th class="thead tr-even col cell-line col-even" data-row="0" data-col="2" style="width:10%"></th><th class="thead tr-even col cell-line col-odd" data-row="0" data-col="3" style="width:50%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="4" style="width:10cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:10%">编号             </th><th class="col thead tr-odd tr-last tr-first col-even" data-row="1" data-col="2" style="font-weight:bold;width:10%">命名            </th><th class="col thead tr-odd tr-last tr-first col-odd" data-row="1" data-col="3" style="font-weight:bold;width:50%">捕获组                                      </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="4" style="font-weight:bold;width:10cm">匹配内容          </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:10%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2" style="width:10%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-odd" data-row="0" data-col="3" style="width:50%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="4" style="width:10cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:10%;background-color:Gainsboro">0                </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2" style="width:10%;background-color:Gainsboro">-               </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3" style="width:50%;background-color:Gainsboro"><code class="code code1" style="color:red">(?&lt;year&gt;\d{4})-(?&lt;date&gt;\d{2}-(?&lt;day&gt;\d\d))</code></td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4" style="width:10cm;background-color:Gainsboro">2008-12-31        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:10%;background-color:White">1                </td><td class="tbody tr-even col col-even" data-row="2" data-col="2" style="width:10%;background-color:White">year            </td><td class="tbody tr-even col col-odd" data-row="2" data-col="3" style="width:50%;background-color:White"><code class="code code1" style="color:red">(?&lt;year&gt;\d{4})</code>                            </td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="4" style="width:10cm;background-color:White">2008              </td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:10%;background-color:Gainsboro">2                </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2" style="width:10%;background-color:Gainsboro">date            </td><td class="tbody tr-odd col col-odd" data-row="3" data-col="3" style="width:50%;background-color:Gainsboro"><code class="code code1" style="color:red">(?&lt;date&gt;\d{2}-(?&lt;day&gt;\d\d))</code>               </td><td class="tbody tr-odd col col-even col-last" data-row="3" data-col="4" style="width:10cm;background-color:Gainsboro">12-31             </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="4" data-col="1" style="width:10%;background-color:White">3                </td><td class="tbody tr-even tr-last col col-even" data-row="4" data-col="2" style="width:10%;background-color:White">day             </td><td class="tbody tr-even tr-last col col-odd" data-row="4" data-col="3" style="width:50%;background-color:White"><code class="code code1" style="color:red">(?&lt;day&gt;\d\d)</code>                              </td><td class="tbody tr-even tr-last col col-even col-last" data-row="4" data-col="4" style="width:10cm;background-color:White">31                </td></tr>
<tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="4" data-col="1" style="width:10%;background-color:White"></td><td class="tbody tr-even col cell-line col-even" data-row="4" data-col="2" style="width:10%;background-color:White"></td><td class="tbody tr-even col cell-line col-odd" data-row="4" data-col="3" style="width:50%;background-color:White"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="4" data-col="4" style="width:10cm;background-color:White"></td></tr></tbody></table><h3 id="sec-29-" class="clearnum h2" data-heading-depth="2" style="display:block">2.9. 非捕获组</h3>
<p class="p noindent">使用 <code class="code code1" style="color:red">(?: )</code> 包含其他表达式，可使被包含的表达式组成一个整体，在被修饰匹配次数时，可作为整体被修饰。与普通分组不同的是，非捕获组不记录所匹配的内容，比普通分组更节约内存资源。
</p><h3 id="sec-210-" class="clearnum h2" data-heading-depth="2" style="display:block">2.10. 反向引用</h3>
<p class="p noindent">捕获组捕获到的内容，不仅可以在正则表达式外部通过程序进行引用，也可以在正则表达式内部进行引用，这种引用方式就是反向引用。反向引用的作用通常是用来查找或限定重复，限定指定标识配对出现等等。反向引用提供了标识字符串中的重复字符或子字符串的方便途径。 例如，如果输入字符串包含某任意子字符串的多个匹配项，则可以使用捕获组匹配第一个出现的子字符串，然后使用反向引用匹配后面出现的子字符串。
</p>
<p class="p indent">普通捕获组反向引用： <code class="code code1" style="color:red">\number</code>。其中编号 number 是正则表达式中捕获组的序号位置。 
命名捕获组反向引用： <code class="code code1" style="color:red">\k&lt;name&gt;</code> 或者 <code class="code code1" style="color:red">\k&#39;name&#39;</code>。其中 name 是正则表达式模式中定义的捕获组的名字的地方。
</p>
<p class="p indent">举例来说，表达式<code class="code code1" style="color:red">(?:([0-9])(?!\1{5})){12}</code>表示允一个12位数字，但其中不能出现6位连续相同数字。
</p>
<ul class="ul list-dash compact">
<li class="li ul-li list-dash-li compact-li">请注意，在有的正则表达式引擎中，使用的八进制转义代码（如 <code class="code code1" style="color:red">\16</code> ）和使用相同表示法的 <code class="code code1" style="color:red">\number</code> 后向引用之间可能会产生多义性。比如，表达式 <code class="code code1" style="color:red">([ab])\10</code>，这里的 <code class="code code1" style="color:red">\10</code> 会被解析成第10个捕获组的反向引用，还是第1个捕获组的反向引用加一个普通字符0呢？不同正则表达式引擎是不一样的。此时，应参看具体的说明文档。如果有多义性问题，可以使用命名捕获组反向引用，该表示法是明确的，并且不会与八进制符号代码混淆。
</li></ul>
<h3 id="sec-211-" class="clearnum h2" data-heading-depth="2" style="display:block">2.11. 注释</h3>
<p class="p noindent">格式 <code class="code code1" style="color:red">(?# xxx )</code> 可用来表示一段注释。
</p><h3 id="sec-212-" class="clearnum h2" data-heading-depth="2" style="display:block">2.12. 预搜索</h3>
<p class="p noindent">判断当前位置的前后字符，是否符合指定的条件，但不匹配前后的字符。
</p>
<p class="p indent">预搜索有向前和向后两种：
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:15%"></th><th class="thead tr-even col cell-line col-even" data-row="0" data-col="2" style="width:20%"></th><th class="thead tr-even col cell-line col-odd col-last" data-row="0" data-col="3" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:15%">表达式           </th><th class="col thead tr-odd tr-last tr-first col-even" data-row="1" data-col="2" style="font-weight:bold;width:20%">方向              </th><th class="col thead tr-odd tr-last tr-first col-odd col-last" data-row="1" data-col="3" style="font-weight:bold;width:20cm">说明                                                    </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:15%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2" style="width:20%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="0" data-col="3" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:15%;background-color:Gainsboro"><code class="code code1" style="color:red">(?=xxx)</code>        </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2" style="width:20%;background-color:Gainsboro">正向预搜索（向右）</td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="3" style="width:20cm;background-color:Gainsboro">正向预搜索，判断当前位置右侧是否能匹配指定表达式        </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:15%;background-color:White"><code class="code code1" style="color:red">(?!xxx)</code>        </td><td class="tbody tr-even col col-even" data-row="2" data-col="2" style="width:20%;background-color:White">正向预搜索（向右）</td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="3" style="width:20cm;background-color:White">正向预搜索否定，判断当前位置右侧是否不能够匹配指定表达式</td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:15%;background-color:Gainsboro"><code class="code code1" style="color:red">(?&lt;=xxx)</code>       </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2" style="width:20%;background-color:Gainsboro">反向预搜索（向左）</td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="3" style="width:20cm;background-color:Gainsboro">反向预搜索，判断当前位置左侧是否能够匹配指定表达式      </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="4" data-col="1" style="width:15%;background-color:White"><code class="code code1" style="color:red">(?&lt;!xxx)</code>       </td><td class="tbody tr-even tr-last col col-even" data-row="4" data-col="2" style="width:20%;background-color:White">反向预搜索（向左）</td><td class="tbody tr-even tr-last col col-odd col-last" data-row="4" data-col="3" style="width:20cm;background-color:White">反向预搜索否定，判断当前位置左侧是否不能够匹配指定表达式</td></tr>
<tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="4" data-col="1" style="width:15%;background-color:White"></td><td class="tbody tr-even col cell-line col-even" data-row="4" data-col="2" style="width:20%;background-color:White"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="4" data-col="3" style="width:20cm;background-color:White"></td></tr></tbody></table><h3 id="sec-213-" class="clearnum h2" data-heading-depth="2" style="display:block">2.13. 条件表达式</h3>
<p class="p noindent">根据某个条件是否成立，来选择匹配 两个可选表达式中的其中一个。
</p>
<p class="p indent">可以用于条件表达式的条件有两种类型：
</p>
<ol class="ol compact">
<li class="li ol-li compact-li">指定捕获组是否进行了捕获。 
</li>
<li class="li ol-li compact-li">文本中当前位置是否可以与指定表达式匹配。 
</li></ol>

<p class="p noindent">条件表达式的格式及说明：
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:22%"></th><th class="thead tr-even col cell-line col-even" data-row="0" data-col="2" style="width:22%"></th><th class="thead tr-even col cell-line col-odd col-last" data-row="0" data-col="3" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:22%">表达式                       </th><th class="col thead tr-odd tr-last tr-first col-even" data-row="1" data-col="2" style="font-weight:bold;width:22%">条件特点         </th><th class="col thead tr-odd tr-last tr-first col-odd col-last" data-row="1" data-col="3" style="font-weight:bold;width:20cm">条件说明                                               </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:22%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2" style="width:22%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="0" data-col="3" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:22%;background-color:Gainsboro"><span style="color:red">(?(1)yes|no)</span>   </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2" style="width:22%;background-color:Gainsboro">条件为数字       </td><td class="tbody tr-odd tr-first col col-odd col-last" data-row="1" data-col="3" style="width:20cm;background-color:Gainsboro">分组1如果有捕获，则进行 <code class="code code1" style="color:red">yes</code> 部分匹配，否则 <code class="code code1" style="color:red">no</code> 部分 </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:22%;background-color:White"><span style="color:red">(?(?=a)aa|bbb)</span> </td><td class="tbody tr-even col col-even" data-row="2" data-col="2" style="width:22%;background-color:White">条件为预搜索     </td><td class="tbody tr-even col col-odd col-last" data-row="2" data-col="3" style="width:20cm;background-color:White">如果当前位置右侧是 <code class="code code1" style="color:red">a</code>，则进行匹配 <code class="code code1" style="color:red">aa</code>，否则匹配 <code class="code code1" style="color:red">bbb</code></td></tr>
<tr><td class="tbody tr-odd col col-odd col-first" data-row="3" data-col="1" style="width:22%;background-color:Gainsboro"><span style="color:red">(?(xxx)aa|bbb)</span> </td><td class="tbody tr-odd col col-even" data-row="3" data-col="2" style="width:22%;background-color:Gainsboro">不与分组命名吻合 </td><td class="tbody tr-odd col col-odd col-last" data-row="3" data-col="3" style="width:20cm;background-color:Gainsboro">如果不与任何分组命名吻合，则视为 <code class="code code1" style="color:red">(?=xxx)</code> 相同        </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="4" data-col="1" style="width:22%;background-color:White"><span style="color:red">(?(name)yes|no)</span></td><td class="tbody tr-even tr-last col col-even" data-row="4" data-col="2" style="width:22%;background-color:White">与分组命名吻合   </td><td class="tbody tr-even tr-last col col-odd col-last" data-row="4" data-col="3" style="width:20cm;background-color:White">如果与某分组命名吻合，则视为判断该分组是否进行捕获     </td></tr>
<tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="4" data-col="1" style="width:22%;background-color:White"></td><td class="tbody tr-even col cell-line col-even" data-row="4" data-col="2" style="width:22%;background-color:White"></td><td class="tbody tr-even col cell-line col-odd col-last" data-row="4" data-col="3" style="width:20cm;background-color:White"></td></tr></tbody></table>
<p class="p noindent">另外：
</p>
<ul class="ul list-dash compact">
<li class="li ul-li list-dash-li compact-li">如果表达式为 RIGHTTOLEFT 模式，那么 <code class="code code1" style="color:red">(?(xxx)aa|bbb)</code> 与 <code class="code code1" style="color:red">(?(?&lt;=xxx)aa|bbb)</code> 相同。 
</li>
<li class="li ul-li list-dash-li compact-li">如果条件表达式只有一个选择项，那么这个选项是在条件成立时进行匹配。 
</li>
<li class="li ul-li list-dash-li compact-li">如果条件表达式中，使用 <code class="code code1" style="color:red">|</code> 进行分隔的选项多于2个，则只有第一个 <code class="code code1" style="color:red">|</code> 被视为条件表达式选项分隔符。比如：<code class="code code1" style="color:red"> (?(?=xxx)yes|no1|no2)</code>，条件成立时，匹配 <code class="code code1" style="color:red">yes</code> 部分，否则匹配 <code class="code code1" style="color:red">no1|no2</code>。 
</li></ul>
<h3 id="sec-214-" class="clearnum h2" data-heading-depth="2" style="display:block">2.14. 递归表达式</h3>
<p class="p noindent">对另一部分子表达式的引用，而不是对其匹配结果的引用。当被引用的表达式包含自身，则形成递归引用。
</p>
<p class="p indent">相对于 &#8220;反向引用&#8221; 来说，反向引用是在匹配过程中，对匹配到的字符串内容进行引用，而 &#8220;递归匹配&#8221; 是对表达式进行引用。举例说明：
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:25%"></th><th class="thead tr-even col cell-line col-even" data-row="0" data-col="2" style="width:25%"></th><th class="thead tr-even col cell-line col-odd" data-row="0" data-col="3" style="width:25%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="4" style="width:10cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:25%">表达式            </th><th class="col thead tr-odd tr-last tr-first col-even" data-row="1" data-col="2" style="font-weight:bold;width:25%">等效的表达式1     </th><th class="col thead tr-odd tr-last tr-first col-odd" data-row="1" data-col="3" style="font-weight:bold;width:25%">等效的表达式2         </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="4" style="font-weight:bold;width:10cm">可以匹配          </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:25%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2" style="width:25%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-odd" data-row="0" data-col="3" style="width:25%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="4" style="width:10cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:25%;background-color:Gainsboro"><code class="code code1" style="color:red">(\w)(?1)</code>        </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2" style="width:25%;background-color:Gainsboro"><code class="code code1" style="color:red">(\w)(\w)</code>        </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3" style="width:25%;background-color:Gainsboro">-                     </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4" style="width:10cm;background-color:Gainsboro"><code class="code code1" style="color:red">ab</code>              </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="2" data-col="1" style="width:25%;background-color:White"><code class="code code1" style="color:red">(?1)(\w(?2))(\d)</code></td><td class="tbody tr-even tr-last col col-even" data-row="2" data-col="2" style="width:25%;background-color:White"><code class="code code1" style="color:red">(?1)(\w(\d))(\d)</code></td><td class="tbody tr-even tr-last col col-odd" data-row="2" data-col="3" style="width:25%;background-color:White"><code class="code code1" style="color:red">(\w(\d))(\w(\d))(\d)</code></td><td class="tbody tr-even tr-last col col-even col-last" data-row="2" data-col="4" style="width:10cm;background-color:White"><code class="code code1" style="color:red">a1b23</code>           </td></tr>
<tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="2" data-col="1" style="width:25%;background-color:White"></td><td class="tbody tr-even col cell-line col-even" data-row="2" data-col="2" style="width:25%;background-color:White"></td><td class="tbody tr-even col cell-line col-odd" data-row="2" data-col="3" style="width:25%;background-color:White"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="2" data-col="4" style="width:10cm;background-color:White"></td></tr></tbody></table>
<p class="p noindent">如果被引用的表达式又包含自身，则形成了递归引用。举例说明：
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:25%"></th><th class="thead tr-even col cell-line col-even" data-row="0" data-col="2" style="width:30%"></th><th class="thead tr-even col cell-line col-odd" data-row="0" data-col="3" style="width:25%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="4" style="width:10cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:25%">表达式                           </th><th class="col thead tr-odd tr-last tr-first col-even" data-row="1" data-col="2" style="font-weight:bold;width:30%">等效的表达式1                                               </th><th class="col thead tr-odd tr-last tr-first col-odd" data-row="1" data-col="3" style="font-weight:bold;width:25%">等效的表达式2    </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="4" style="font-weight:bold;width:10cm">可以匹配          </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:25%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even" data-row="0" data-col="2" style="width:30%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-odd" data-row="0" data-col="3" style="width:25%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="4" style="width:10cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:25%;background-color:Gainsboro"><code class="code code1" style="color:red">(\w(?1)?)</code>                      </td><td class="tbody tr-odd tr-first col col-even" data-row="1" data-col="2" style="width:30%;background-color:Gainsboro"><span style="color:red">(\w(\w(?1)?)?)</span>                                 </td><td class="tbody tr-odd tr-first col col-odd" data-row="1" data-col="3" style="width:25%;background-color:Gainsboro"><code class="code code1" style="color:red">(\w+)</code>          </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="4" style="width:10cm;background-color:Gainsboro"><code class="code code1" style="color:red">ghjk5……</code>         </td></tr>
<tr><td class="tbody tr-even tr-last col col-odd col-first" data-row="2" data-col="1" style="width:25%;background-color:White"><code class="code code1" style="color:red">(([^()]</code><span style="color:red">|</span><code class="code code1" style="color:red">(?R))*)</code></td><td class="tbody tr-even tr-last col col-even" data-row="2" data-col="2" style="width:30%;background-color:White"><code class="code code1" style="color:red">(([^()]</code><span style="color:red">|</span><code class="code code1" style="color:red">(([^()]</code><span style="color:red">|</span><code class="code code1" style="color:red">(?R))*))*)</code></td><td class="tbody tr-even tr-last col col-odd" data-row="2" data-col="3" style="width:25%;background-color:White">-                </td><td class="tbody tr-even tr-last col col-even col-last" data-row="2" data-col="4" style="width:10cm;background-color:White"><code class="code code1" style="color:red">(a * (c + 2))</code>   </td></tr>
<tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="2" data-col="1" style="width:25%;background-color:White"></td><td class="tbody tr-even col cell-line col-even" data-row="2" data-col="2" style="width:30%;background-color:White"></td><td class="tbody tr-even col cell-line col-odd" data-row="2" data-col="3" style="width:25%;background-color:White"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="2" data-col="4" style="width:10cm;background-color:White"></td></tr></tbody></table>
<p class="p noindent">递归表达式格式有：
</p><table class="madoko block" style="tbody-tr-odd-background-color:Gainsboro;tr-even-background-color:White;line-height:2em">
<thead><tr><th class="thead tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:40%"></th><th class="thead tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm"></th></tr>
<tr><th class="col thead tr-odd tr-last tr-first col-odd col-first" data-row="1" data-col="1" style="font-weight:bold;width:40%">格式                            </th><th class="col thead tr-odd tr-last tr-first col-even col-last" data-row="1" data-col="2" style="font-weight:bold;width:20cm">说明                      </th></tr></thead>
<tbody><tr><td class="tbody tr-even col cell-line col-odd col-first" data-row="0" data-col="1" style="width:40%;background-color:Gainsboro"></td><td class="tbody tr-even col cell-line col-even col-last" data-row="0" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr>
<tr><td class="tbody tr-odd tr-first col col-odd col-first" data-row="1" data-col="1" style="width:40%;background-color:Gainsboro"><code class="code code1" style="color:red">(?R)</code>                          </td><td class="tbody tr-odd tr-first col col-even col-last" data-row="1" data-col="2" style="width:20cm;background-color:Gainsboro">对整个表达式的递归引用。  </td></tr>
<tr><td class="tbody tr-even col col-odd col-first" data-row="2" data-col="1" style="width:40%;background-color:White"><code class="code code1" style="color:red">(?1)</code>，<code class="code code1" style="color:red">(?2)</code>，<code class="code code1" style="color:red">(?R1)</code>，<code class="code code1" style="color:red">(?R2)</code></td><td class="tbody tr-even col col-even col-last" data-row="2" data-col="2" style="width:20cm;background-color:White">对指定分组的递归引用。    </td></tr>
<tr><td class="tbody tr-odd tr-last col col-odd col-first" data-row="3" data-col="1" style="width:40%;background-color:Gainsboro"><code class="code code1" style="color:red">(?R&lt;named&gt;)</code>，<code class="code code1" style="color:red">(?R&#39;named&#39;)</code>    </td><td class="tbody tr-odd tr-last col col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro">对指定命名分组的递归引用。</td></tr>
<tr><td class="tbody tr-odd col cell-line col-odd col-first" data-row="3" data-col="1" style="width:40%;background-color:Gainsboro"></td><td class="tbody tr-odd col cell-line col-even col-last" data-row="3" data-col="2" style="width:20cm;background-color:Gainsboro"></td></tr></tbody></table><h2 id="sec-3-" class="clearnum h1" data-heading-depth="1" style="display:block">3. 正则表达式的建议</h2>
<ul class="ul list-dash compact">
<li class="li ul-li list-dash-li compact-li">能匹配空字符串的子匹配不要循环无限次。如果括号内的子表达式中的每一部分都可以匹配 0 次，而这个括号整体又可以匹配无限次，那么匹配过程中可能死循环。虽然现在有些正则表达式引擎已经通过办法避免了这种情况出现死循环了，但我们仍然应该尽量避免出现这种情况。
</li>
<li class="li ul-li list-dash-li compact-li">表达式不要匹配空字符串。否则会一直得到匹配成功，而结果什么都没有匹配到。
</li>
<li class="li ul-li list-dash-li compact-li">合理选择贪婪模式与非贪婪模式。
</li>
<li class="li ul-li list-dash-li compact-li">或 <code class="code code1" style="color:red">|</code> 的左右两边，对某个字符最好只有一边可以匹配，这样，不会因为 <code class="code code1" style="color:red">|</code> 两边的表达式因为交换位置而有所不同。
</li></ul></div><span data-line=""></span></div>
</body>
<script type="text/javascript">
  // ---------------------------------------------
      // Classname helpers
      // ---------------------------------------------
      function hasClassName(elem,cname) {
        if (elem==null) return false;
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        return regex.test(elem.className);
      }
      
      function removeClassName(elem,cname) {
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        elem.className = elem.className.replace( regex, "" );
      }
      
      function addClassName(elem,cname) {
        if (!hasClassName(elem,cname)) elem.className = elem.className + " " + cname;
      }
      
      function toggleClassName(elem,cname) {
        var regex = new RegExp("\\s*\\b" + cname + "\\b","g");
        var classes = elem.className;
        if (regex.test(classes)) {
          elem.className = classes.replace( regex, "" );
          return false;
        }
        else {
          elem.className = classes + " " + cname;
          return true;
        }
      }
      
      // ---------------------------------------------
      // Reliable offset determination
      // ---------------------------------------------
      
      function getWindowOffset(elem) {
        var box;
        if (elem.getBoundingClientRect) {
          box = elem.getBoundingClientRect();
        }
        else if (elem.offsetParent && elem.offsetParent.getBoundingClientRect) {
          // text node
          box = elem.offsetParent.getBoundingClientRect();
          box.top = box.top + elem.offsetTop;
          box.left = box.left + elem.offsetLeft;
        }
        else {
          box = { top: 0, left : 0 };
        }
        return box;
      }
      
      // Return the viewport position: -1 (before), 0 (visible), 1 (after)
      function viewportPosition(elem) {
        var pos = getWindowOffset(elem)
        if (pos.top < 0 || pos.left < 0) 
          return -1;
        else if (pos.top > (window.innerHeight || document.documentElement.clientHeight) ||
                 pos.left > (window.innerWidth || document.documentElement.clientWidth)) 
          return 1;
        else 
          return 0;
      }
      
      // ---------------------------------------------
      // Expand the toc sections and align headers with the toc.
      // ---------------------------------------------
      
      var side = document.getElementsByClassName("sidepanel")[0];
      var afterScroll = null;
      
      // Align a heading at the top of the page with the toc
      function alignHeading( elem ) {
        var ofs     = getWindowOffset(elem).top;
        var sideofs = getWindowOffset(side).top;
        if (ofs >= 0 && ofs < sideofs) {
          window.scrollBy(0, ofs - sideofs);
        } 
      }
      
      // Expand, or unexpand, one toc item
      // The class is 'auto-expands' or 'click-expands'; the latter is sticky
      // as it is user induced and will not be automatically unexpanded.
      function itemExpand(item,cls,expand) {
        // get possible toc block (that follows the item)
        var tocblock = item.nextElementSibling;
        if (tocblock==null || !hasClassName(tocblock,"tocblock")) return;
       
        // set expand class
        if (expand===undefined) expand = !hasClassName(tocblock,"expands");
        if (cls===undefined) cls = "auto-expands" 
        if (cls==="click-expands") removeClassName(tocblock,"auto-expands");
        if (expand && !hasClassName(tocblock,cls)) {
          toggleClassName(tocblock,cls); 
        }
        else if (!expand && hasClassName(tocblock,cls)) {
          toggleClassName(tocblock,cls);
          item.firstElementChild.className = "unexpanded";
        }
        
        // set expansion icon
        if (hasClassName(tocblock,"auto-expands") || hasClassName(tocblock,"click-expands")) {
          item.firstElementChild.className = "expanded";   
        }
        else {
          item.firstElementChild.className = "unexpanded";
        }
      }
      
      // Expand a single item in the toc (and unexpand others).
      function itemExpandOne(item) {
        // unexpand anything that was expanded
        [].forEach.call( document.querySelectorAll(".tocitem"), function(item) {
          removeClassName(item,"current");
          itemExpand(item,"auto-expands",false);      
        });
        addClassName(item,"current");
        // expand the chain of parent blocks
        var tocblock = null;
        var toc = item.nextElementSibling;
        if (toc && hasClassName(toc,"tocblock")) { 
          tocblock = toc;
        }
        else {
          tocblock = item.parentElement;
        }
        while(tocblock != null && !hasClassName(tocblock,"toc")) {
          if (hasClassName(tocblock,"tocblock")) {
            item = tocblock.previousElementSibling;
            if (item != null) itemExpand(item,"auto-expands",true);
          }
          tocblock = tocblock.parentElement;
        }
      }
      
      // Auto expand the toc at current  position in the document 
      function expandToc() {
        // find the first section heading that is visible in the viewport 
        var current = null;
        [].every.call( document.querySelectorAll(".tocitem"), function(item) {
          var target = document.getElementById( item.getAttribute("data-toc-target") );
          var pos = viewportPosition(target);
          if (pos <= 0) current = item;
          return (pos < 0);
        });
        // if found, expand the corresponding item
        if (current != null) itemExpandOne(current);
      }
      
      document.addEventListener("load", function(ev) { expandToc(); });
      document.addEventListener("resize", function(ev) { expandToc(); });
      
      // fire at end of scrolling
      var scrollHandler = null;
      document.addEventListener("scroll", function(ev) {
        if (scrollHandler) clearTimeout(scrollHandler);
        scrollHandler = setTimeout( function() {
          scrollHandler = null;
          if (afterScroll) {
            afterScroll();
            afterScroll = null;
          }
          else {
            expandToc();
          }
        }, 50 );
      });
      
      // ---------------------------------------------
      // Install event handlers for all items in the TOC
      // ---------------------------------------------
      [].forEach.call( document.querySelectorAll(".tocitem"), function(item) {
        // only for toc items with a target
        var target = document.getElementById( item.getAttribute("data-toc-target") );
        if (!target) return;
        
        // ensure every tocblock has a expansion icon in front
        // (the optional nested tocblock follows the item)
        var tocblock = null;
        var toc = item.nextElementSibling;  
        if (toc && hasClassName(toc,"tocblock")) { 
          tocblock = toc;
          item.innerHTML = "<span class='unexpanded'></span>" + item.innerHTML;   
        } 
        
        // on a click
        item.addEventListener( "click", function() {
          // expand this toc item and set expansion icon
          itemExpand(item,"click-expands");
          // after navigation, align the heading with the toc
          afterScroll = (function() {
            alignHeading(target);
          });    
        }); 
      });
</script>

</html>
